---
title: ライプニッツ則（積の微分法則）
layout: ../../../../layouts/BlogPostLayout.astro
---

# ライプニッツ則（積の微分法則）

ライプニッツ則（積の微分法則）を証明せよ。

すなわち、2つの関数

$$f(x), g(x)$$

の積の微分が次のようになることを示せ：

$$
\frac{d}{dx} [f(x)g(x)] = f'(x)g(x) + f(x)g'(x)
$$

---

### 補助定理：二項定理

ライプニッツ則の証明において、二項定理が重要な役割を果たす。まず、二項定理を証明しておく。

**定理（二項定理）**
任意の実数 $$a, b$$ と非負整数 $$n$$ に対して、

$$
(a + b)^n = \sum_{k=0}^{n} \binom{n}{k} a^{n-k} b^k
$$

が成り立つ。ここで $$\binom{n}{k} = \frac{n!}{k!(n-k)!}$$ は二項係数である。

**証明**
数学的帰納法により証明する。

**基底ケース** $$n = 0$$ のとき：
$$(a + b)^0 = 1 = \binom{0}{0} a^0 b^0$$
なので成り立つ。

**帰納ステップ** $$n = k$$ で成り立つと仮定する。すなわち、
$$(a + b)^k = \sum_{i=0}^{k} \binom{k}{i} a^{k-i} b^i$$
とする。

$$n = k + 1$$ の場合を考える：
$$(a + b)^{k+1} = (a + b)(a + b)^k$$

帰納仮定を用いて：
$$(a + b)^{k+1} = (a + b) \sum_{i=0}^{k} \binom{k}{i} a^{k-i} b^i$$

$$= a \sum_{i=0}^{k} \binom{k}{i} a^{k-i} b^i + b \sum_{i=0}^{k} \binom{k}{i} a^{k-i} b^i$$

$$= \sum_{i=0}^{k} \binom{k}{i} a^{k+1-i} b^i + \sum_{i=0}^{k} \binom{k}{i} a^{k-i} b^{i+1}$$

第二項のインデックスを $$j = i + 1$$ と置換すると：

$$= \sum_{i=0}^{k} \binom{k}{i} a^{k+1-i} b^i + \sum_{j=1}^{k+1} \binom{k}{j-1} a^{k+1-j} b^j$$

係数をまとめると：
- $$j = 0$$ の項：$$\binom{k}{0} a^{k+1} = \binom{k+1}{0} a^{k+1}$$ （n個から0個を選ぶのは常に1通りだから）
- $$j = k+1$$ の項：$$\binom{k}{k} b^{k+1} = \binom{k+1}{k+1} b^{k+1}$$
- $$1 \leq j \leq k$$ の項：$$\binom{k}{j} a^{k+1-j} b^j + \binom{k}{j-1} a^{k+1-j} b^j$$

パスカルの三角形の性質により：
$$\binom{k}{j} + \binom{k}{j-1} = \binom{k+1}{j}$$

これは、パスカルの三角形における隣り合う2つの数の和が下の行の数になるという性質である：

```
        1
       1 1
      1 2 1
     1 3 3 1
    1 4 6 4 1
   1 5 10 10 5 1
  1 6 15 20 15 6 1
 ...
```

例えば、第4行の3と3を足すと第5行の6になる（$$\binom{4}{1} + \binom{4}{2} = 3 + 3 = 6 = \binom{5}{2}$$）。

組み合わせ論的にも理解できる：k+1個の対象からj個選ぶ方法は、
- 最初の1個を含まずにk個からj個選ぶ：$$\binom{k}{j}$$通り
- 最初の1個を含んでk個からj-1個選ぶ：$$\binom{k}{j-1}$$通り
の和に等しい。

したがって：
$$(a + b)^{k+1} = \sum_{j=0}^{k+1} \binom{k+1}{j} a^{k+1-j} b^j$$

よって、数学的帰納法により二項定理が成り立つ。□
